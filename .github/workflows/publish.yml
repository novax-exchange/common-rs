name: Action to publish to crate io

on: workflow_dispatch

jobs:
  log:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - uses: davidkhala/setup-rs@main
      - run: cargo login ${{ secrets.CRATES_IO_API_TOKEN }}
      - run: cargo publish -p novax-log
  http:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - uses: davidkhala/setup-rs@main
      - run: cargo login ${{ secrets.CRATES_IO_API_TOKEN }}
      - run: cargo publish -p novax-http

  grpc:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - uses: davidkhala/setup-rs@main
      - run: cargo login ${{ secrets.CRATES_IO_API_TOKEN }}
      - run: cargo publish -p novax-grpc

  sqlx-mysql:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - uses: davidkhala/setup-rs@main
      - name: Login crates.io
        run: cargo login ${{ secrets.CRATES_IO_API_TOKEN }}
      - run: cargo publish -p novax-sqlx-mysql

  sqlx-postgres:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - uses: davidkhala/setup-rs@main
      - run: cargo login ${{ secrets.CRATES_IO_API_TOKEN }}
      - run: cargo publish -p novax-sqlx-postgres
  tokio:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@main
      - uses: davidkhala/setup-rs@main
      - run: cargo login ${{ secrets.CRATES_IO_API_TOKEN }}
      - run: cargo publish -p novax-tokio